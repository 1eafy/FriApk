<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Report</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!--    {#  <link rel="stylesheet" href="//res.layui.com/layui/dist/css/layui.css"  media="all">#}-->
    <link rel="stylesheet" href="../static/layui-v2.5.7/layui/css/layui.css" media="all">
</head>
<body>
<style>
    body {
        font-family: 'Consolas', '幼圆', 'Deja Vu Sans Mono', 'Bitstream Vera Sans Mono', monospace;
    }

    .test {
        height: 20px;
        width: 100%;
        border: #0C0C0C 1px solid;
        position: relative;
        top: -20px;
        z-index: 5;
    }

    .guide {
        position: relative;
        top: 50px;
    }

    img {
        border-radius: 100px;
        /*{#-webkit-border-radius: 9px;#}{#-moz-border-radius: 9px;"#}*/
    }
</style>


<div class="layui-main layui-row" style="margin-top: 50px">
    <!-- 导航 -->

    <div class="layui-col-md2 layui-inline ">
        <ul class="layui-nav layui-nav-tree layui-inline">
            <li class="layui-nav-item "><a href="#index-1">基本信息</a></li>
            <li class="layui-nav-item "><a href="#index-2">签名信息</a></li>
            <li class="layui-nav-item "><a href="#index-3">权限列表</a></li>
            <li class="layui-nav-item "><a href="#index-4">敏感信息</a></li>
            <li class="layui-nav-item"><a href="javascript:;">漏洞详情</a>
                <dl class="layui-nav-child">
                    <dd><a href="#vuln-1">{{data['component_exported'].title}}</a></dd>
                    <dd><a href="#vuln-2">{{data['intent-based'].title}}</a></dd>
                    <dd><a href="#vuln-3">{{data['backup'].title}}</a></dd>
                    <dd><a href="#vuln-4">{{data['allow_debug'].title}}</a></dd>
                    <dd><a href="#vuln-5">{{data['des_weak'].title}}</a></dd>
                    <dd><a href="#vuln-6">{{data['sqlite_see'].title}}</a></dd>
                    <dd><a href="#vuln-7">{{data['sql_cipher'].title}}</a></dd>
<!--                    <dd><a href="#">网络通信安全检测</a></dd>-->
<!--                    <dd><a href="#">弱加密风险检测</a></dd>-->
<!--                    <dd><a href="#">数据安全检测</a></dd>-->
                </dl>
            </li>
<!--            <li class="layui-nav-item"><a href="#">系统API调用检测</a></li>-->
        </ul>
    </div>


    <div class="layui-container layui-col-md8" style="width: 900px; display: inline-block;">
        <!-- apk info  -->
        <fieldset id="index-1" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['apk_info'].title}}</legend>
        </fieldset>

        <div style="padding: 20px" class="layui-bg-gray">
            <div class="layui-row layui-col-space15">

                <div class="layui-col-md10">
                    <div class="layui-card">
                        <table class="layui-table" lay-even="" lay-skin="row">
                            <colgroup>
                                <col width="150">
                                <col width="150">
                            </colgroup>
                            <tbody>
                            <tr>
                                <td><span class="layui-badge layui-bg-black">应用名称</span></td>
                                <td>{{data['apk_info'].name}}</td>

                            </tr>

                            <tr>
                                <td><span class="layui-badge layui-bg-black">应用大小</span></td>
                                <td>{{data['apk_info'].size}} Bytes</td>

                            </tr>
                            <tr>
                                <td><span class="layui-badge layui-bg-black">应用版本</span></td>
                                <td>{{data['apk_info'].version}}</td>

                            </tr>
                            <tr>
                                <td><span class="layui-badge layui-bg-black">加固</span></td>
                                <td>
                                    {% if data['apk_info'].dump_status %}
                                    <a href="../static/dexdump/{{ uid }}.zip">{{data['apk_info'].protect}}</a>
                                    {% else %}
                                    {{data['apk_info'].protect}}
                                    {% endif %}
                                </td>

                            </tr>
                            <tr>
                                <td><span class="layui-badge layui-bg-black">签名</span></td>
                                <td>
                                    {%if data['apk_info'].sign%}
                                    <span class="layui-badge layui-bg-green">已签</span>
                                    {%else%}
                                    <span class="layui-badge layui-bg-gray">未签名</span>
                                    {%endif%}
                                </td>

                            </tr>

                            <tr>
                                <td><span class="layui-badge layui-bg-black">包名</span></td>
                                <td>{{data['apk_info'].package}}</td>

                            </tr>
                            <tr>
                                <td><span class="layui-badge layui-bg-black">MainActivity</span></td>
                                <td>{{data['apk_info'].MainActivity}}</td>

                            </tr>
                            <tr>
                                <td><span class="layui-badge layui-bg-black">MD5</span></td>
                                <td>{{data['apk_info'].MD5}}</td>

                            </tr>
                            <tr>
                                <td><span class="layui-badge layui-bg-black">上传时间</span></td>
                                <td>{{upload_time}}</td>

                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="layui-col-md2">
                    {% if data['icon']%}
                    <img src="../static/{{ uid }}.png" style="width: 100px;height: 100px;"
                         alt={{data['apk_info'].name}}>
                    {% else %}
                    <img src="../static/default.png" style="width: 100px;height: 100px;" alt={{data['apk_info'].name}}>
                    {% endif %}
                </div>

            </div>
        </div>
        <!-- END -->

        <hr class="layui-bg-green">

        <!--  cert info  -->
        <fieldset id="index-2" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['cert_info'].title}}</legend>
        </fieldset>

        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">签名信息
                    {%if data['cert_info'].res %}
                    <span class="layui-badge-dot layui-bg-green"></span>
                    {%else%}
                    <span class="layui-badge-dot layui-bg-gray"></span>
                    {%endif%}

                </h2>
                <div class="layui-colla-content">
                    <div class="layui-col-md12">
                        <div class="layui-card">
                            <table class="layui-table" lay-even="" lay-skin="row">
                                <colgroup>
                                    <col width="100">
                                    <col width="100">
                                </colgroup>
                                <tbody>

                                {% for k, v in data['cert_info'].field.items() %}
                                <tr>
                                    <td>
                                        {{k}}
                                    </td>
                                    <td>
                                        {{v}}
                                    </td>
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>
            </div>

        </div>


        <!-- END -->

        <hr class="layui-bg-green">

        <!-- permission  -->
        <fieldset id="index-3" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>权限列表</legend>
        </fieldset>
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">权限信息 <span class="layui-badge-dot layui-bg-orange"></span></h2>
                <div class="layui-colla-content">
                    <div class="layui-col-md12">
                        <div class="layui-card">
                            <table class="layui-table" lay-even="" lay-skin="row">
                                <colgroup>
                                    <col width="150">
                                    <col width="150">
                                </colgroup>
                                <tbody>
                                {% for p in data['permission']['p_list']%}
                                <tr>
                                    <td>{{p['name']}}
                                        {% if p['level'] == 1 %}
                                        <span class="layui-badge">危</span>
                                        {% endif %}
                                    </td>
                                    <td>{{p['des']}}</td>

                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </div>


        <hr class="layui-bg-green">

        <!-- sen info -->
        <fieldset id="index-4" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['sen_info'].title}}</legend>
        </fieldset>
        <div class="layui-collapse">
            {% for k, v in data['sen_info'].type.items() %}
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">{{k}}
                    {% if v|length > 0 %}
                    <span class="layui-badge-dot"></span>
                    {% endif %}
                </h2>
                <div class="layui-colla-content">
                    <div class="layui-col-md12">
                        <div class="layui-card">
                            <table class="layui-table" lay-even="" lay-skin="row">
                                <colgroup>
                                    <col width="150">
                                    <col width="150">
                                </colgroup>
                                <tbody>
                                {% for i in v%}
                                <tr>
                                    <td>
                                        {{i}}
                                    </td>


                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor%}
        </div>
        <!-- END -->

        <hr class="layui-bg-green">

        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>漏洞详情</legend>
        </fieldset>

        <fieldset id="vuln-1" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['component_exported'].title}}</legend>
        </fieldset>
        <blockquote class="layui-elem-quote">{{data['component_exported'].desc}}<br/>
            修复建议：<br/>
            {% for s in data['component_exported'].suggestion %}
            {{s}}<br/>
            {% endfor %}
        </blockquote>
        {% if data['component_exported'].poc | length > 0 %}
        <pre class="layui-code">{% for p in data['component_exported'].poc %}{{p}}{% endfor %}</pre>
        {% endif %}
        <div class="layui-collapse">
            {% for k, v in data['component_exported'].type.items()%}
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">{{k | upper}}
                    {% if v | length > 0 %}
                    <span class="layui-badge layui-bg-orange">低</span>
                    {% else %}
                    <span class="layui-badge layui-bg-green">通过</span>
                    {% endif %}
                </h2>
                <div class="layui-colla-content">
                    <div class="layui-col-md12">
                        <div class="layui-card">
                            <table class="layui-table" lay-even="" lay-skin="row">
                                <colgroup>
                                    <col width="150">
                                    <col width="150">
                                </colgroup>
                                <tbody>
                                {% for i in v%}
                                <tr>
                                    <td>{{i}}</td>
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <hr class="layui-bg-green">

        <fieldset id="vuln-2" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['intent-based'].title}}</legend>
        </fieldset>
        {% if data['intent-based'].res%}
        <blockquote class="layui-elem-quote">{{data['intent-based'].desc}}<br/>
            修复建议：<br/>
            {% for s in data['intent-based'].suggestion %}
            {{s}}<br/>
            {% endfor %}
        </blockquote>
        {% if data['intent-based'].poc | length > 0 %}
        <pre class="layui-code">{% for p in data['intent-based'].poc %}{{p}}{% endfor %}</pre>
        {% endif %}
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">{{data['intent-based'].title}} <span
                        class="layui-badge-dot layui-bg-orange"></span></h2>
                <div class="layui-colla-content">
                    <div class="layui-col-md12">
                        <div class="layui-card">
                            <table class="layui-table" lay-even="" lay-skin="row">
                                <colgroup>
                                    <col width="150">
                                    <col width="150">
                                </colgroup>
                                <tbody>
                                {% for i in data['intent-based'].vuln_component%}
                                <tr>
                                    <td>{{i}}</td>
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {%else%}
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">{{data['intent-based'].title}} <span
                        class="layui-badge layui-bg-green">通过</span></h2>
                <div class="layui-colla-content"></div>
            </div>
        </div>

        {%endif%}
        <hr class="layui-bg-green">


        <fieldset id="vuln-3" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['backup'].title}}</legend>
        </fieldset>

        <blockquote class="layui-elem-quote">{{data['backup'].desc}}<br/>
            修复建议：<br/>
            {% for s in data['backup'].suggestion %}
            {{s}}<br/>
            {% endfor %}
        </blockquote>
        {% if data['backup'].poc | length > 0 %}
        <pre class="layui-code">{% for p in data['backup'].poc %}{{p}}{% endfor %}</pre>
        {% endif %}
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">{{data['backup'].title}}
                    {% if data['backup'].res %}
                    <span class="layui-badge">危</span>
                    {%else%}
                    <span class="layui-badge layui-bg-green">通过</span>
                    {% endif %}

                </h2>
                <!--                <div class="layui-colla-content">-->
                <!--                    -->
                <!--                </div>-->
            </div>
        </div>


        <hr class="layui-bg-green">
        <fieldset id="vuln-4" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['allow_debug'].title}}</legend>
        </fieldset>

        <blockquote class="layui-elem-quote">{{data['allow_debug'].desc}}<br/>
            修复建议：<br/>
            {% for s in data['allow_debug'].suggestion %}
            {{s}}<br/>
            {% endfor %}
        </blockquote>
        {% if data['allow_debug'].poc | length > 0 %}
        <pre class="layui-code">{% for p in data['allow_debug'].poc %}{{p}}{% endfor %}</pre>
        {% endif %}
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">{{data['allow_debug'].title}}
                    {% if data['allow_debug'].res %}
                    <span class="layui-badge">危</span>
                    {%else%}
                    <span class="layui-badge layui-bg-green">通过</span>
                    {% endif %}

                </h2>
                <!--                <div class="layui-colla-content">-->
                <!--                    -->
                <!--                </div>-->
            </div>
        </div>


        <hr class="layui-bg-green">
        <fieldset id="vuln-5" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['des_weak'].title}}</legend>
        </fieldset>

        <blockquote class="layui-elem-quote">{{data['des_weak'].desc}}<br/>
            修复建议：<br/>
            {% for s in data['des_weak'].suggestion %}
            {{s}}<br/>
            {% endfor %}
        </blockquote>
        {% if data['des_weak'].poc | length > 0 %}
        <pre class="layui-code">{% for p in data['des_weak'].poc %}{{p}}{% endfor %}</pre>
        {% endif %}
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">{{data['des_weak'].title}}
                    {% if data['des_weak'].res %}
                        <span class="layui-badge layui-bg-orange">注</span>
                    {%else%}
                        <span class="layui-badge layui-bg-green">通过</span>
                    {% endif %}

                </h2>
                <!--                <div class="layui-colla-content">-->
                <!--                    -->
                <!--                </div>-->
            </div>
        </div>



         <hr class="layui-bg-green">
        <fieldset id="vuln-6" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['sqlite_see'].title}}</legend>
        </fieldset>

        <blockquote class="layui-elem-quote">{{data['sqlite_see'].desc}}<br/>
            修复建议：<br/>
            {% for s in data['sqlite_see'].suggestion %}
            {{s}}<br/>
            {% endfor %}
        </blockquote>
        {% if data['sqlite_see'].code | length > 0 %}
            <pre class="layui-code">{% for p in data['sqlite_see'].code %}{{p}}{% endfor %}</pre>
        {% endif %}
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">{{data['sqlite_see'].title}}
                    {% if data['sqlite_see'].res %}
                        <span class="layui-badge layui-bg-orange">提醒</span>
                    {%else%}
                        <span class="layui-badge layui-bg-green">通过</span>
                    {% endif %}

                </h2>
                <!--                <div class="layui-colla-content">-->
                <!--                    -->
                <!--                </div>-->
            </div>
        </div>


         <hr class="layui-bg-green">
        <fieldset id="vuln-7" class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>{{data['sql_cipher'].title}}</legend>
        </fieldset>

        <blockquote class="layui-elem-quote">{{data['sql_cipher'].desc}}<br/>
            修复建议：<br/>
            {% for s in data['sql_cipher'].suggestion %}
            {{s}}<br/>
            {% endfor %}
        </blockquote>
        {% if data['sql_cipher'].code | length > 0 %}
            <pre class="layui-code">{% for p in data['sql_cipher'].code %}{{p}}{% endfor %}</pre>
        {% endif %}
        <div class="layui-collapse">
            <div class="layui-colla-item">
                <h2 class="layui-colla-title">{{data['sql_cipher'].title}}
                    {% if data['sql_cipher'].res %}
                        <span class="layui-badge layui-bg-orange">提醒</span>
                    {%else%}
                        <span class="layui-badge layui-bg-green">通过</span>
                    {% endif %}

                </h2>
                <!--                <div class="layui-colla-content">-->
                <!--                    -->
                <!--                </div>-->
            </div>
        </div>



    </div>
</div>


<!--<div class="layui-collapse">-->
<!--    <div class="layui-colla-item">-->
<!--        <h2 class="layui-colla-title">杜甫</h2>-->
<!--        <div class="layui-colla-content layui-show">内容区域</div>-->
<!--    </div>-->
<!--</div>-->


<script src="../static/layui-v2.5.7/layui/layui.js" charset="utf-8"></script>
<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
<script>
    layui.use('code', function () { //加载code模块
        layui.code(); //引用code方法
    });
    layui.use('element', function () {
        var element = layui.element; //导航的hover效果、二级菜单等功能，需要依赖element模块

        //监听导航点击
        element.on('nav(demo)', function (elem) {
            //console.log(elem)
            {
                // layer.msg(elem.text());

            }
        });
    });
</script>

</body>
</html>